window.onload = function() {
    
    //var request = new XMLHttpRequest();
    //request.onreadystatechange = function(){
        //if (request.readyState === 4) {
            //data = request.responseText;
            //jsonData = JSON.parse(data);
        //}
    //};

    //request.open("GET", "minsk-final.json", true);
    //request.send(null);
    
    var jsonData = [
    {"budgeted": [[2015, 10583826835.5], [2013, 3327927495.7], [2014, 8002700157], [2007, 271407663.5], [2008, 419721083.2], [2009, 327231375], [2010, 556791140.9], [2011, 402505452.9], [2012, 1944921786.5]], "spent": [[2013, 2097468714.9], [2012, 1084041365.3], [2011, 360143664.4], [2010, 203688566.3], [2007, 203867661.4], [2008, 240571472.4], [2009, 477338709.6]], "title": "\u041e\u0431\u0449\u0435\u0433\u043e\u0441\u0443\u0434\u0430\u0440\u0441\u0442\u0432\u0435\u043d\u043d\u0430\u044f \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c", "id": "1"},
    {"budgeted": [[2015, 7506666.8], [2013, 22115495.1], [2014, 2994477], [2007, 1463851.5], [2008, 1866697], [2009, 2892407.6], [2010, 425185], [2011, 5158675], [2012, 6293638]], "spent": [[2013, 27843050], [2012, 15072470.9], [2011, 6750223], [2010, 578239.7], [2007, 1338517.2], [2008, 1787183.2], [2009, 1881974.1]], "title": "\u041d\u0430\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u0430\u044f \u043e\u0431\u043e\u0440\u043e\u043d\u0430", "id": "2"},
    {"budgeted": [[2015, 202101703], [2013, 210061894.2], [2014, 183910523], [2007, 56692520], [2008, 69507651], [2009, 90707669], [2010, 28892729], [2011, 36127652.5], [2012, 72546158]], "spent": [[2013, 150283741.1], [2012, 97109304.1], [2011, 68629411.6], [2010, 31266002.3], [2007, 64004966.7], [2008, 71333265.4], [2009, 71340948.7]], "title": "\u0421\u0443\u0434\u0435\u0431\u043d\u0430\u044f \u0432\u043b\u0430\u0441\u0442\u044c, \u043f\u0440\u0430\u0432\u043e\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0438 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u0435 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438", "id": "3"}, 
    {"budgeted": [[2015, 3231166727.3], [2013, 2520915678.7], [2014, 3169826024], [2007, 540066714], [2008, 503017616], [2009, 1055989735.8], [2010, 843664566], [2011, 854992911], [2012, 2154059415.5]], "spent": [[2013, 4045269201.4], [2012, 2885832352.6], [2011, 1320249115.9], [2010, 864637162.5], [2007, 650192184.9], [2008, 775864351.3], [2009, 864506581.1]], "title": "\u041d\u0430\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u0430\u044f \u044d\u043a\u043e\u043d\u043e\u043c\u0438\u043a\u0430", "id": "4"}, {"budgeted": [[2015, 50992659.7], [2013, 64065950], [2014, 65781390], [2010, 66195200], [2011, 48268629], [2012, 54985791]], "spent": [[2013, 28115733.6], [2012, 38450151.4], [2011, 27652827.6], [2010, 42368727.9]], "title": "\u041e\u0445\u0440\u0430\u043d\u0430 \u043e\u043a\u0440\u0443\u0436\u0430\u044e\u0449\u0435\u0439 \u0441\u0440\u0435\u0434\u044b", "id": "5"}, {"budgeted": [[2015, 6228458059.2], [2013, 6049067467.1], [2014, 5404271819.4], [2007, 817100688], [2008, 1310602945], [2009, 1653640468], [2010, 1568153151], [2011, 1438116909.8], [2012, 3925575974]], "spent": [[2013, 7289978048.4], [2012, 4913264237.5], [2011, 2000993588], [2010, 1416987556.7], [2007, 1066799561.3], [2008, 1402239571.2], [2009, 1537988286.8]], "title": "\u0416\u0438\u043b\u0438\u0449\u043d\u043e-\u043a\u043e\u043c\u043c\u0443\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0443\u0441\u043b\u0443\u0433\u0438 \u0438 \u0436\u0438\u043b\u0438\u0449\u043d\u043e\u0435 \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u043e", "id": "6"},
    {"budgeted": [[2015, 7711282867], [2013, 5141915192], [2014, 5648653242.4], [2007, 673280027], [2008, 760434252], [2009, 1100722137], [2010, 1062885037], [2011, 1583804141], [2012, 3360900234]], "spent": [[2013, 5031971033.8], [2012, 3896555917.8], [2011, 2101714937.5], [2010, 1239557326], [2007, 731931066.7], [2008, 847243038.8], [2009, 961193779]], "title": "\u0417\u0434\u0440\u0430\u0432\u043e\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435", "id": "7"},
    {"budgeted": [[2015, 1305683331.6], [2013, 2030301176.6], [2014, 1338727021.4], [2007, 134963215], [2008, 191788818], [2009, 241588065.2], [2010, 216330340.2], [2011, 480782905.2], [2012, 1393674902]], "spent": [[2013, 2797209931.3], [2012, 1775236366], [2011, 597229088.6], [2010, 341488204.7], [2007, 156849034.5], [2008, 214815192.6], [2009, 254180864.1]], "title": "\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043a\u0443\u043b\u044c\u0442\u0443\u0440\u0430, \u0441\u043f\u043e\u0440\u0442, \u043a\u0443\u043b\u044c\u0442\u0443\u0440\u0430 \u0438 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430 \u043c\u0430\u0441\u0441\u043e\u0432\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438", "id": "8"},
    {"budgeted": [[2015, 6795388617.9], [2013, 5027539195.3], [2014, 5399326111.3], [2007, 730014776], [2008, 912962397], [2009, 1295259270.4], [2010, 1098717491.9], [2011, 1607071591.6], [2012, 3307869176]], "spent": [[2013, 4793490411.3], [2012, 3736787522.2], [2011, 1978028583.9], [2010, 1200921095.2], [2007, 718516853.4], [2008, 913117855.1], [2009, 1015137721.4]], "title": "\u041e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435", "id": "9"},
    {"budgeted": [[2015, 1185051213], [2013, 896271112.4], [2014, 919332218.5], [2007, 105220842], [2008, 205858383], [2009, 248266549], [2010, 263331382], [2011, 344216192], [2012, 641894311]], "spent": [[2013, 716391623], [2012, 630505414.4], [2011, 397404632.2], [2010, 270547127.9], [2007, 139573241.1], [2008, 226993126.8], [2009, 218406976.6]], "title": "\u0421\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u0430\u044f \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0430", "id": "10"},
    {"budgeted": [[2015, 37301458681], [2013, 25290180657.1], [2014, 30135522984], [2007, 3330210297], [2008, 4375759842.2], [2009, 6016297677], [2010, 5705386223], [2011, 6801045060], [2012, 16862721386]], "spent": [[2013, 26978021488.8], [2012, 19072855102.2], [2011, 8858796072.7], [2010, 5612040009.2], [2007, 3733073087.2], [2008, 4693965056.8], [2009, 5402280841.4]], "title": "\u0412\u0441\u0435\u0433\u043e \u0440\u0430\u0441\u0445\u043e\u0434\u043e\u0432", "id": "11"}
    ];

    
    for (var i in jsonData) {
        var target = document.getElementById("chartArea");
        var dataItem = jsonData[i];
        var divId = dataItem.id;
        var placeHolder = document.createElement("div");
        placeHolder.setAttribute("id", divId);
        placeHolder.setAttribute("class", "chart");
        target.appendChild(placeHolder);
        

        $(document).ready(function() {
            $.jqplot(divId, [dataItem.budgeted, dataItem.spent], {
                title: dataItem.title,
                axesDefaults: {
                    labelRenderer: $.jqplot.CanvasAxisLabelRenderer
                },
                axes: {
                    yaxis: {
                        label: "тыс. рублей",
                    }
                },
            series:[
            {label:'По плану'},
            {label:'По факту'} ],
            legend: {
                show: true,
                location: 'nw',     // compass direction, nw, n, ne, e, se, s, sw, w.
                xoffset: 12,        // pixel offset of the legend box from the x (or x2) axis.
                yoffset: 12,        // pixel offset of the legend box from the y (or y2) axis.
                },
            highlighter: {
                show: true,
                sizeAdjust: 7.5,
                showMarker: false,
                tooltipAxes: "xy", // См. без х
                yvalues: 5,
                formatString: "<table class='jqplot-highlighter'> \
                                <tr><td>Год:</td><td>%s</td></tr> \
                                <tr><td>Сумма:</td><td>%s</td></tr> \
                                </table>"
            },
            cursor: {
                show: false
            }
                
            });
        });
    }
};
